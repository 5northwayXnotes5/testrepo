<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Driving Tracker</title>
    
    <!-- PWA Settings -->
    <meta name="theme-color" content="#0f172a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Driving">
    
    <!-- Embedded Icon (SVG Base64) -->
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzBmMTcyYSI+PHBhdGggZD0iTTQ0OCAyNTZjMCAxMDYtODYgMTkyLTE5MiAxOTJTNjQgMzYyIDY0IDI1NiAxNTAgNjQgMjU2IDY0czE5MiA4NiAxOTIgMTkyeiIgZmlsbD0iIzBmMTcyYSIvPjxwYXRoIGQ9IkNMMTg5LjIgMTEySDc0LjhjLTguOCAwLTE2IDcuMi0xNiAxNnY0OGMwIDguOCA3LjIgMTYgMTYgMTZoMzEuN2wxMi4zIDQ5LjNDMTIwLjkgMjQ5LjYgMTI4IDI1NiAxMzYuOCAyNTZoMzguNGM4LjggMCAxNi03LjIgMTYtMTZ2LTE2aDU5LjZ2MTZjMCA4LjggNy4yIDE2IDE2IDE2aDM4LjRjOC44IDAgMTUuOS02LjQgMTguNC0xNC43bDEyLjMtNDkuM2gzMS43YzguOCAwIDE2LTcuMiAxNi0xNnYtNDhjMC04LjgtNy4yLTE2LTE2LTE2aC0xNC40bC00NC44LTg5LjZDMyAwIDExLjUgMjkzLjYgMiAyODUuNiAyaC04My4yYy04IDAtMTQuNCA5LjYtMTguNCAxNy42bC00NC44IDg5LjZ6IiBmaWxsPSIjMzRkMzk5Ii8+PC9zdmc+">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzBmMTcyYSI+PHBhdGggZD0iTTQ0OCAyNTZjMCAxMDYtODYgMTkyLTE5MiAxOTJTNjQgMzYyIDY0IDI1NiAxNTAgNjQgMjU2IDY0czE5MiA4NiAxOTIgMTkyeiIgZmlsbD0iIzBmMTcyYSIvPjxwYXRoIGQ9IkNMMTg5LjIgMTEySDc0LjhjLTguOCAwLTE2IDcuMi0xNiAxNnY0OGMwIDguOCA3LjIgMTYgMTYgMTZoMzEuN2wxMi4zIDQ5LjNDMTIwLjkgMjQ5LjYgMTI4IDI1NiAxMzYuOCAyNTZoMzguNGM4LjggMCAxNi03LjIgMTYtMTZ2LTE2aDU5LjZ2MTZjMCA4LjggNy4yIDE2IDE2IDE2aDM4LjRjOC44IDAgMTUuOS02LjQgMTguNC0xNC43bDEyLjMtNDkuM2gzMS43YzguOCAwIDE2LTcuMiAxNi0xNnYtNDhjMC04LjgtNy4yLTE2LTE2LTE2aC0xNC40bC00NC44LTg5LjZDMyAwIDExLjUgMjkzLjYgMiAyODUuNiAyaC04My4yYy04IDAtMTQuNCA5LjYtMTguNCAxNy42bC00NC44IDg5LjZ6IiBmaWxsPSIjMzRkMzk5Ii8+PC9zdmc+">

    <!-- Embedded Manifest (JSON Base64) -->
    <link rel="manifest" href="data:application/manifest+json;base64,eyJuYW1lIjoiRHJpdmluZyBUcmFja2VyIiwic2hvcnRfbmFtZSI6IkRyaXZpbmciLCJzdGFydF91cmwiOiIuIiwiZGlzcGxheSI6InN0YW5kYWxvbmUiLCJiYWNrZ3JvdW5kX2NvbG9yIjoiIzBmMTcyYSIsInRoZW1lX2NvbG9yIjoiIzBmMTcyYSIsImljb25zIjpbeyJzcmMiOiJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTVMTXk1dmNtY3ZNakF3TUM5emRtY2lJSFpwWlhkdFltOTRQU0l3SURBd05URXlOVEV5IiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzBmMTcyYSI+PHBhdGggZD0iTTQ0OCAyNTZjMCAxMDYtODYgMTkyLTE5MiAxOTJTNjQgMzYyIDY0IDI1NiAxNTAgNjQgMjU2IDY0czE5MiA4NiAxOTIgMTkyeiIgZmlsbD0iIzBmMTcyYSIvPjxwYXRoIGQ9IkNMMTg5LjIgMTEySDc0LjhjLTguOCAwLTE2IDcuMi0xNiAxNnY0OGMwIDguOCA3LjIgMTYgMTYgMTZoMzEuN2wxMi4zIDQ5LjNDMTIwLjkgMjQ5LjYgMTI4IDI1NiAxMzYuOCAyNTZoMzguNGM4LjggMCAxNi03LjIgMTYtMTZ2LTE2aDU5LjZ2MTZjMCA4LjggNy4yIDE2IDE2IDE2aDM4LjRjOC44IDAgMTUuOS02LjQgMTguNC0xNC43bDEyLjMtNDkuM2gzMS43YzguOCAwIDE2LTcuMiAxNi0xNnYtNDhjMC04LjgtNy4yLTE2LTE2LTE2aC0xNC40bC00NC44LTg5LjZDMyAwIDExLjUgMjkzLjYgMiAyODUuNiAyaC04My4yYy04IDAtMTQuNCA5LjYtMTguNCAxNy42bC00NC44IDg5LjZ6IiBmaWxsPSIjMzRkMzk5Ii8+PC9zdmc+IiwidHlwZSI6ImltYWdlL3N2Zyt4bWwiLCJzaXplcyI6IjUxMng1MTIifV19">

    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f172a; color: #f1f5f9; font-family: sans-serif; -webkit-tap-highlight-color: transparent; }
        .day-btn { transition: all 0.2s; }
        .day-btn:active { transform: scale(0.95); }
        .modal-enter { opacity: 0; pointer-events: none; transform: scale(0.95); }
        .modal-active { opacity: 1; pointer-events: auto; transform: scale(1); }
        .transition-modal { transition: all 0.2s ease-out; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4">

    <div class="w-full max-w-md space-y-6">
        
        <div class="bg-slate-800 rounded-2xl p-6 shadow-lg border border-slate-700 relative">
            <!-- Install Button (Hidden by default) -->
            <button id="install-btn" class="hidden absolute top-4 right-4 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 p-2 rounded-lg transition-colors" title="Install App">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5"/><path d="M12 3v13.5"/><path d="m8.25 12.75 3.75 3.75 3.75-3.75"/></svg>
            </button>

            <div class="flex justify-between items-end mb-2">
                <div>
                    <h1 class="text-2xl font-bold text-white">Driving Progress</h1>
                    <p class="text-slate-400 text-sm">Target: 26 Classes</p>
                </div>
                <div class="text-3xl font-bold text-emerald-400">
                    <span id="total-count">0</span><span class="text-slate-500 text-lg">/26</span>
                </div>
            </div>
            
            <div class="h-4 bg-slate-700 rounded-full overflow-hidden mb-4">
                <div id="progress-bar" class="h-full bg-gradient-to-r from-emerald-500 to-teal-400 transition-all duration-500 ease-out" style="width: 0%"></div>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <div class="bg-slate-700/50 p-3 rounded-xl flex items-center gap-3">
                    <div class="p-2 bg-blue-500/20 text-blue-400 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/></svg>
                    </div>
                    <div>
                        <div class="text-xs text-slate-400 uppercase font-semibold">Road</div>
                        <div id="road-count" class="text-xl font-bold">0</div>
                    </div>
                </div>
                <div class="bg-slate-700/50 p-3 rounded-xl flex items-center gap-3">
                    <div class="p-2 bg-amber-500/20 text-amber-400 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
                    </div>
                    <div>
                        <div class="text-xs text-slate-400 uppercase font-semibold">Maneuvers (H)</div>
                        <div id="h-count" class="text-xl font-bold">0</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-slate-800 rounded-2xl shadow-lg border border-slate-700 overflow-hidden">
            <div class="p-4 flex items-center justify-between border-b border-slate-700 bg-slate-800/50">
                <button id="prev-month" class="p-2 hover:bg-slate-700 rounded-full transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m15 18-6-6 6-6"/></svg>
                </button>
                <h2 id="month-display" class="text-lg font-bold"></h2>
                <button id="next-month" class="p-2 hover:bg-slate-700 rounded-full transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>
                </button>
            </div>

            <div class="p-4">
                <div class="grid grid-cols-7 mb-2 text-center text-xs font-bold text-slate-500">
                    <div class="py-2">S</div><div class="py-2">M</div><div class="py-2">T</div><div class="py-2">W</div><div class="py-2">T</div><div class="py-2">F</div><div class="py-2">S</div>
                </div>
                <div id="calendar-grid" class="grid grid-cols-7 gap-2"></div>
            </div>
        </div>
    </div>

    <div id="modal-backdrop" class="fixed inset-0 bg-black/60 backdrop-blur-sm z-40 hidden transition-modal modal-enter flex items-center justify-center p-4">
        <div id="modal-content" class="bg-slate-800 p-6 rounded-2xl w-full max-w-sm shadow-2xl border border-slate-700 transform transition-modal" onclick="event.stopPropagation()">
            <h3 class="text-xl font-bold mb-1 text-white">Log Class</h3>
            <p id="modal-date-display" class="text-slate-400 text-sm mb-6"></p>
            
            <div class="grid grid-cols-2 gap-3 mb-4">
                <button onclick="setLesson('Road')" class="flex items-center justify-center gap-2 p-4 rounded-xl bg-blue-600 hover:bg-blue-500 text-white font-bold transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/></svg>
                    Road
                </button>
                <button onclick="setLesson('H')" class="flex items-center justify-center gap-2 p-4 rounded-xl bg-amber-600 hover:bg-amber-500 text-white font-bold transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
                    Maneuver
                </button>
            </div>
            
            <button id="delete-btn" onclick="setLesson(null)" class="w-full flex items-center justify-center gap-2 p-3 rounded-xl border border-red-500/30 text-red-400 hover:bg-red-500/10 font-medium transition-colors hidden">
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
                Remove Entry
            </button>
            <button onclick="closeModal()" class="w-full mt-3 p-3 text-slate-500 hover:text-slate-300 font-medium transition-colors">Cancel</button>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'driving_tracker_v1';
        let lessons = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};
        let currentDate = new Date();
        let selectedDateKey = null;

        const monthDisplay = document.getElementById('month-display');
        const calendarGrid = document.getElementById('calendar-grid');
        const totalCountEl = document.getElementById('total-count');
        const roadCountEl = document.getElementById('road-count');
        const hCountEl = document.getElementById('h-count');
        const progressBar = document.getElementById('progress-bar');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const modalDateDisplay = document.getElementById('modal-date-display');
        const deleteBtn = document.getElementById('delete-btn');
        const installBtn = document.getElementById('install-btn');

        // PWA Install Logic
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installBtn.classList.remove('hidden');
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                installBtn.classList.add('hidden');
            }
        });

        function saveLessons() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify(lessons));
            updateStats();
            renderCalendar();
        }

        function updateStats() {
            const values = Object.values(lessons);
            const total = values.length;
            const road = values.filter(v => v === 'Road').length;
            const h = values.filter(v => v === 'H').length;
            
            totalCountEl.textContent = total;
            roadCountEl.textContent = road;
            hCountEl.textContent = h;
            
            const percentage = Math.min((total / 26) * 100, 100);
            progressBar.style.width = `${percentage}%`;
        }

        function formatDateKey(date) {
            const y = date.getFullYear();
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const d = String(date.getDate()).padStart(2, '0');
            return `${y}-${m}-${d}`;
        }

        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            monthDisplay.textContent = currentDate.toLocaleDateString('default', { month: 'long', year: 'numeric' });
            
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            
            calendarGrid.innerHTML = '';

            for (let i = 0; i < firstDay; i++) {
                const empty = document.createElement('div');
                calendarGrid.appendChild(empty);
            }

            const todayKey = formatDateKey(new Date());

            for (let d = 1; d <= daysInMonth; d++) {
                const date = new Date(year, month, d);
                const key = formatDateKey(date);
                const type = lessons[key];
                const isToday = key === todayKey;

                const btn = document.createElement('button');
                btn.className = `day-btn aspect-square rounded-xl flex flex-col items-center justify-center relative 
                    ${type === 'Road' ? 'bg-blue-600/20 border-2 border-blue-500/50 text-blue-100' : 
                      type === 'H' ? 'bg-amber-600/20 border-2 border-amber-500/50 text-amber-100' : 
                      'bg-slate-700/30 hover:bg-slate-700 text-slate-300'}
                    ${isToday && !type ? 'ring-2 ring-emerald-500/50' : ''}`;
                
                btn.onclick = () => openModal(key);
                
                let content = `<span class="text-sm font-medium">${d}</span>`;
                if (type) {
                    content += `<span class="text-[10px] font-bold mt-1 ${type === 'Road' ? 'text-blue-400' : 'text-amber-400'}">${type === 'Road' ? 'ROAD' : 'H'}</span>`;
                }
                
                btn.innerHTML = content;
                calendarGrid.appendChild(btn);
            }
        }

        function openModal(dateKey) {
            selectedDateKey = dateKey;
            modalDateDisplay.textContent = new Date(dateKey).toLocaleDateString('default', { weekday: 'long', month: 'long', day: 'numeric' });
            
            if (lessons[dateKey]) {
                deleteBtn.classList.remove('hidden');
            } else {
                deleteBtn.classList.add('hidden');
            }

            modalBackdrop.classList.remove('hidden');
            setTimeout(() => {
                modalBackdrop.classList.remove('modal-enter');
                modalBackdrop.classList.add('modal-active');
            }, 10);
        }

        function closeModal() {
            modalBackdrop.classList.remove('modal-active');
            modalBackdrop.classList.add('modal-enter');
            setTimeout(() => {
                modalBackdrop.classList.add('hidden');
            }, 200);
            selectedDateKey = null;
        }

        function setLesson(type) {
            if (selectedDateKey) {
                if (type) {
                    lessons[selectedDateKey] = type;
                } else {
                    delete lessons[selectedDateKey];
                }
                saveLessons();
            }
            closeModal();
        }

        document.getElementById('prev-month').onclick = () => {
            currentDate.setMonth(currentDate.getMonth() - 1);
            renderCalendar();
        };

        document.getElementById('next-month').onclick = () => {
            currentDate.setMonth(currentDate.getMonth() + 1);
            renderCalendar();
        };

        document.getElementById('modal-backdrop').onclick = closeModal;

        updateStats();
        renderCalendar();
    </script>
</body>
</html>


